(function(o,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(o=typeof globalThis<"u"?globalThis:o||self,n(o.spicyJSRouter={}))})(this,function(o){"use strict";let n;const C=()=>n,j=".router-outlet",q=({target:t=j},r)=>{typeof t=="string"?t=document.querySelector(t):typeof t=="function"&&(t=t()),t.replaceChildren(r)},g=async(t,r)=>{var i,b;const[s,c=""]=t.split("?"),a=Object.fromEntries(new URLSearchParams(c)),[,...f]=s.split("/");for(const e of r){let w=e.path;w.startsWith("/")&&(w=w.slice(1));const y=w.split("/");let h={};for(let l=0;l<y.length;l++){const U=l===y.length-1,m=y[l],R=f[l];if(m.startsWith(":")&&(h[m.slice(1)]=R),R!==m&&e.path!=="*"&&!m.startsWith(":"))break;if(U){if(await((i=e.before)==null?void 0:i.call(e,{params:h,query:a}))===!1)return;const W=await e.handler({params:h,query:a});q(e,W),n=e,await((b=e.after)==null?void 0:b.call(e,{params:h,query:a})),h={};const L=f.slice(l);e.children&&L.length&&await g(L.join("/"),e.children);return}}}},u=async()=>{var t;(t=n==null?void 0:n.onRouteChange)==null||t.call(n,n),await P()!==!1&&(await g(window.location.pathname,p),await E())},d=async()=>{};let p=[],P=d,E=d;const v=t=>P=t||d,F=t=>E=t||d,M=async t=>(p=t,window.removeEventListener("popstate",u),window.addEventListener("popstate",u),u()),O=(t,r={})=>t.replace(/:([^/]+)/g,(s,c)=>r[c].toString()),S=(t,r,s="")=>{for(const{name:c,path:a,children:f}of t){if(c===r)return s+a;if(f){const i=S(f,r,s+a);if(i)return i}}throw new Error(`No route found with name ${name}`)},T=({path:t="",name:r="",params:s,query:c={},delta:a,replace:f})=>{if(a)return window.history.go(a);t||(t=S(p,r)),t=O(t,s);const i=new URLSearchParams(c).toString();return t+=i?`?${i}`:"",f?window.history.replaceState(null,"",t):window.history.pushState(null,"",t),u()};o.afterEach=F,o.beforeEach=v,o.createRouter=M,o.getCurrentRoute=C,o.go=T,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
