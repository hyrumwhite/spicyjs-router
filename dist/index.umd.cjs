(function(n,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(n=typeof globalThis<"u"?globalThis:n||self,s(n.spicyJSRouter={}))})(this,function(n){"use strict";const s=window.history;let a;const j=()=>a,q=".router-outlet",v=({target:t=q},o)=>{typeof t=="string"?t=document.querySelector(t):typeof t=="function"&&(t=t()),t.replaceChildren(o)},P=async(t,o)=>{var i,R;const[c,f=""]=t.split("?"),r=Object.fromEntries(new URLSearchParams(f)),[,...l]=c.split("/");for(const e of o){let p=e.path;p.startsWith("/")&&(p=p.slice(1));const g=p.split("/");let h={};for(let u=0;u<g.length;u++){const W=u===g.length-1,w=g[u],L=l[u];if(w.startsWith(":")&&(h[w.slice(1)]=L),L!==w&&e.path!=="*"&&!w.startsWith(":"))break;if(W){if(await((i=e.before)==null?void 0:i.call(e,{params:h,query:r}))===!1)return;const I=await e.handler({params:h,query:r});v(e,I),a=e,await((R=e.after)==null?void 0:R.call(e,{params:h,query:r})),h={};const C=l.slice(u);e.children&&C.length&&await P(C.join("/"),e.children);return}}}},d=async()=>{var t;(t=a==null?void 0:a.onRouteChange)==null||t.call(a,a),await E()!==!1&&(await P(window.location.pathname,y),await S())},m=async()=>{};let y=[],E=m,S=m;const F=t=>E=t||m,M=t=>S=t||m,O=async t=>(y=t,window.removeEventListener("popstate",d),window.addEventListener("popstate",d),d()),T=(t,o={})=>t.replace(/:([^/]+)/g,(c,f)=>o[f].toString()),b=(t,o,c="")=>{for(const{name:f,path:r,children:l}of t){if(f===o)return c+r;if(l){const i=b(l,o,c+r);if(i)return i}}throw new Error(`No route found with name ${name}`)},U=({path:t="",name:o="",params:c,query:f={},delta:r,replace:l})=>{if(r)return s.go(r);t||(t=b(y,o)),t=T(t,c);const i=new URLSearchParams(f).toString();return t+=i?`?${i}`:"",l?s.replaceState(null,"",t):s.pushState(null,"",t),d()};n.afterEach=M,n.beforeEach=F,n.createRouter=O,n.getCurrentRoute=j,n.go=U,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
